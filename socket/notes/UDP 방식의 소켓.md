# UDP
네크워크 소켓에서 사용되는 대표적인 두가지 방식에는 TCP와 UDP 방식이 있다. 앞서서 말한것 처럼 TCP 소켓은 신뢰성이 보장되는 통신 방식이고 UDP는 신뢰성을 보장되지 않지만, 속도가 빠른 특성을 지닌다.

## UDP 소켓의 특성
UDP 소켓이 빠르지만 신뢰성이 보장되지 않는 이유는 UDP 소켓이 지닌 특성에 있다. UDP 소켓은 TCP 소켓과 다르게, 데이터를 전송한 후, 상대방이 데이터를 제대로 송신했는지 확인하지 않는다. 쉽게 묘사하자면, UDP는 편지를 보낸다고 생각하면 된다. 수신자의 정보를 적고 전송하고 그 이후는 신경쓰지 않기 때문이다. 

## UDP vs TCP
TCP 소켓은 신뢰성이 보장되지만, 통신 속도가 UDP에 느리다는 단점이 있다. 하지만 UDP는 속도는 TCP에 비해 빠르지만, 신뢰성이 보장되지 않는다는 단점이 있다. 어느 한가지 방식이 옳은것은 아니고, 각 방식의 장점과 단점을 고려해서 적절하게 사용해야할것이다.

UDP와 TCP의 핵심적인 차이점은 **데이터의 흐름 제어**라고 볼수있다. TCP 소켓의 경우 데이터의 신뢰성 보장을 위해서 흐름제어를 통해 데이터를 관리하고, 신뢰성으 확보 할 수 있다. 또한 이러한 흐름제어로 인해 TCP가 UDP에 비해 느린것이다. 또한 TCP는 UDP에 비해서 서버와 클라이언트의 소켓을 연결하는 추가적인 과정이 필요하기 때문에 UDP에 비해서 속도가 느려질수 있다.

UDP 소켓이 사용될수 있는 곳에는 대표적으로 실시간 스트리밍의 통신 방법으로 사용될수 있다. 실시간 스트리밍은 데이터의 신뢰성보다 속도가 더 중요하기 때문이다. 또한 신뢰성이 보장되지 않는다고 하여도 데이터 전송 과정에서 큰 손실은 발생하는 일이 드물다.

TCP 소켓을 사용하는 경우는 압축 파일의 전송 상황에서 사용할수 있다. 왜냐하면, 압축 파일은 1 바이트라도 손실되게 되면, 압축 파일이 손상 될 위험이 있기 때문이다.

## UDP 소켓의 생성과 데이터 전송
TCP 소켓은 서버와 클라이언트가 1대 1의 관계여서 만약 서버가 10개의 클라이언트와 연결한다면, 10개의 소켓이 필요했다. 하지만 UDP 소켓은 하나의 소켓만으로 여러 호스트와 데이터 전송이 가능하다. 

TCP 소켓을 생성할 때는 연결 할 호스트의 주소 정보를 입력해야 했는데, UDP는 호스트간의 연결을 유지하지 않으므로 데이터를 전송 할 때 마다 전송할 목적지 호스트의 주소 정보를 입력해야한다.

먼저 UDP 소켓을 생성하기 위해서는 socket 함수의 두번째 인자만 아래와 같이 바꾸어 주면 된다.
```cpp
int sock = socket(PF_INET, SOCK_DGRAM, 0);
```

아래는 UDP 소켓의 데이터 통신에 이용되는 함수들이다.
```cpp
ssize_t sendto(int sock, void* buf, size_t nbytes, int flags, struct sockaddr* to, socklen_t addrlen);
```

함수의 4번째 인자 까지는 send 함수와 동일하다. 하지만 UDP 함수의 특성으로 인해 송신할 데이터의 목적지 주소 정보를 struct sockaddr* to, socklen_t addrlen 인자들로 통해 전달하고 있다.

```cpp
ssize_t recvfrom(int sock, void* buf, size_t nbytes, int flags, struct sockaddr* from, socklen_t addrlen);
```
이 함수도 마찬가지로 recv 함수와 유사하다. 하지만 struct sockaddr* from, socklen_t addrlen 인자들을 통해 데이터가 전송된 출발 주소의 정보를 얻고있다.