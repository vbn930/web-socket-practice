# Half-Close
일반적으로 소켓의 연결을 끊을 때 사용하는 함수인 close()와 closesocket() 함수는 양방향 연결, 즉 수신과 송신 연결을 한번에 종료한다는 단점이 있다. 이 단점을 극복하고 수신 혹은 송신 스트림 중 하나만 종료하여 남은 데이터를 모두 수신 혹은 송신 후 완전히 종료하는 방식을 Half-Close 방식이라고 한다.

## 소켓의 데이터 전송 순서
소켓의 종료 방식을 공부하기 전에 소켓의 데이터 전송 순서에 대해서 알아야 한다. 소켓은 데이터를 주고받을때, 주고받을 데이터들을 버퍼에 임시로 저장 후 네트워크를 통해 주고받는데, 이때 수신 받은 데이터를 임시로 저장되는 버퍼가 입력 버퍼, 송신한 데이터가 임시로 저장되는 버퍼가 출력 버퍼이다.

## 소켓의 종료와 버퍼
소켓이 만약 close 혹은 closesocket으로 종료 된다면, 소캣을 연결하던 양방향 스트림이 종료된다. 이때, 만약 버퍼에서 네트워크로 전송되지 못하고 남은 데이터가 남아있다면, 이 남은 데이터들이 유실될수 있다.

## Graceful Shutdown
위와 같은 상황을 방지하기 위해서 shutdown 함수를 이용해 소켓의 연결을 일부분만 종료 한 후, close 함수를 통해 완전히 종료 해야한다. shutdown를 호출하면, 버퍼에 남아있던 데이터가 플러시되고, 네트워크를 통해서 전송된다. 그리고 상대 호스트에 소켓 연결이 종료되었다는 패킷을 전송합니다. 이렇게 버퍼를 모두 비우고 종료를 알린 뒤, close 함수를 호출해서 소켓을 완전히 종료하는게 권장되는 방법이다.